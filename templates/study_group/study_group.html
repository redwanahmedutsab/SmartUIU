{% load static %}
<!doctype html>
<html lang="en">
{% include 'expendable/head.html' %}

<body id="top">
{% include 'expendable/chatbot_and_loading.html' %}

<div class="site-wrap">

    <div class="site-mobile-menu site-navbar-target">
        <div class="site-mobile-menu-header">
            <div class="site-mobile-menu-close mt-3">
                <span class="icon-close2 js-menu-toggle"></span>
            </div>
        </div>
        <div class="site-mobile-menu-body"></div>
    </div> <!-- .site-mobile-menu -->

    <!-- NAVBAR -->
    {% include 'expendable/navbar.html' %}

    <!-- HOME -->
    <section class="section-hero home-section overlay inner-page bg-image"
             style="background-image: url('{% static 'images/hero_1.jpg' %}');" id="home-section">

        <div class="container">
            <div class="row align-items-center justify-content-center">
                <div class="col-md-12 text-center">
                    <h1 class="text-white font-weight-bold">Welcome to the group study section.</h1>
                    <p class="text-white font-weight-bold">Connect with your mates to make study easier!</p>
                </div>
                <div class="container mt-5">
                    <div class="row align-items-center justify-content-center">
                        <div class="col-md-6 text-center">
                            <div class="d-grid gap-3">
                                <a href="{% url 'study_group_create_group' %}"
                                   class="btn btn-warning btn-lg mb-1 custom-btn shadow-lg">
                                    <i class="fas fa-plus"> Create Group</i> <!-- Icon for Create Group -->
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Chat-like Group Listings Section -->
    <section class="site-section" id="available-groups">
        <div class="container">
            <div class="row mb-5 justify-content-center">
                <div class="col-md-7 text-center">
                    <h2 class="section-title mb-2">Available Study Groups</h2>
                </div>
            </div>

            <div class="group-listings">
                {% for group in groups %}
                    <div class="group-listing d-flex align-items-center">
                        <a href="{% url 'study_group_chat' group.id %}"
                           class="flex-grow-1 d-flex align-items-center text-decoration-none">
                            <div class="group-image">
                                {% if group.image %}
                                    <img src="{{ group.image.url }}" alt="{{ group.name }}"
                                         class="img-fluid rounded-circle">
                                {% else %}
                                    <div class="default-avatar"></div>  <!-- Default avatar if no image -->
                                {% endif %}
                            </div>
                            <div class="group-info">
                                <h5 class="group-name">{{ group.name }}</h5>
                                <p class="group-description">{{ group.description }}</p>
                                <small class="group-meta">Admin: {{ group.creator.get_full_name }}
                                    - {{ group.creator.email }} | {{ group.get_members.count }} members</small>
                            </div>
                        </a>
                        {% if group.creator == request.user %}
                            <div class="ml-3">
                                <!-- Add Member Button -->
                                <a href="{% url 'edit_members' group.id %}"
                                   class="btn btn-success btn-sm d-inline-block">
                                    <i class="fas fa-user-plus"></i> <!-- Icon for Add Member -->
                                </a>

                                <!-- Remove Member Button -->
                                <a href="{% url 'edit_members' group.id %}"
                                   class="btn btn-danger btn-sm d-inline-block">
                                    <i class="fas fa-user-times"></i> <!-- Icon for Remove Member -->
                                </a>

                                <!-- Delete Group Form -->
                                <form action="{% url 'delete_group' group.id %}" method="POST" class="d-inline-block"
                                      onsubmit="return confirm('Are you sure you want to delete this group?');">
                                    {% csrf_token %}
                                    <button type="submit" class="btn btn-warning btn-sm">
                                        <i class="fas fa-trash"></i> <!-- Icon for Delete Group -->
                                    </button>
                                </form>
                            </div>

                        {% endif %}
                    </div>
                {% empty %}
                    <p>No groups available. Start creating one!</p>
                {% endfor %}
            </div>
        </div>
    </section>

    {% include 'expendable/footer.html' %}
</div>

{% include 'expendable/include.html' %}

<style>
    /* Chat-like Style */
    .group-listings {
        max-height: 500px; /* Limit height for scrolling */
        overflow-y: auto; /* Enable scrolling */
        padding: 0;
        margin: 0;
        list-style: none;
    }

    .group-listing {
        display: flex;
        align-items: center;
        padding: 15px;
        border-bottom: 1px solid #ddd; /* Divider line */
        text-decoration: none; /* Remove underline */
        color: #000; /* Text color */
        transition: background-color 0.3s, transform 0.3s;
        border-radius: 8px; /* Rounded corners */
        background-color: #f9f9f9; /* Light background color */
    }

    .group-listing:hover {
        background-color: #e6f7ff; /* Light blue background on hover */
        transform: scale(1.02); /* Slightly enlarge on hover */
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); /* Add shadow on hover */
    }

    .group-image {
        flex-shrink: 0; /* Prevent the image from shrinking */
        margin-right: 15px; /* Space between image and text */
    }

    .group-image img {
        width: 50px; /* Fixed width for avatar */
        height: 50px; /* Fixed height for avatar */
        border-radius: 50%; /* Circular avatar */
        border: 2px solid #007bff; /* Blue border around the image */
    }

    .default-avatar {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: #e0e0e0; /* Gray color for default avatar */
    }

    .group-name {
        margin: 0;
        font-weight: bold;
        color: #007bff; /* Blue color for group name */
    }

    .group-description {
        margin: 0;
        color: #555; /* Subtle description color */
    }

    .group-meta {
        color: #999; /* Light color for meta information */
    }

    /* Buttons */
    .custom-btn {
        font-size: 1.3rem;
        padding: 15px 20px;
        border-radius: 50px;
        transition: transform 0.3s ease, background-color 0.3s ease;
        letter-spacing: 1px;
    }

    .custom-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
    }

    .btn-warning {
        background-color: #e0c9a5;
        border: none;
    }

    .btn-warning:hover {
        background-color: #e68900;
    }

    .btn-info {
        background-color: #17a2b8;
        border: none;
    }

    .btn-info:hover {
        background-color: #138496;
    }

    .btn-success {
        background-color: #28a745;
        border: none;
    }

    .btn-success:hover {
        background-color: #218838;
    }

    /* Shadow effect for a more impactful design */
    .shadow-lg {
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
    }
</style>
</body>
</html>
